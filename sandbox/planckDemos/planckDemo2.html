<html>
<head>
  <meta name="viewport" content="width=device-width">
  <title>Collisions - Planck.js</title>
</head>

<body>

<script src="../../../js/planck.js-0.1.34/dist/planck-with-testbed.js"></script>

<script>


planck.testbed('Collition', function(testbed) {
  var pl = planck, Vec2 = pl.Vec2, Math = pl.Math;

  var width = 16.00, height = 8.00;
  var BALL_R = 0.25;

  testbed.x = 0;
  testbed.y = 0;

  testbed.width = width * 1.2;
  testbed.height = height * 1.2;
  testbed.ratio = 100;
  testbed.mouseForce = -30;
  pl.internal.Settings.velocityThreshold = 0;

  var world = pl.World({});

  var botFixDef = {
    friction: 0.1,
    restitution: 0.99,
    mass: 1,
    userData: 'bot'
  };

  var botBodyDef = {
    linearDamping: 0.1,
    angularDamping: 0.2
  };
  
  for(var i=0;i<6; i++){
    var bot = world.createDynamicBody(botBodyDef);
    bot.setBullet(true);
    var pos_y = (i%2)? BALL_R/2 : -BALL_R/2;
    bot.setPosition({x: (i*2), y: pos_y});
    bot.createFixture(pl.Circle(BALL_R), botFixDef);
    bot.setLinearVelocity(Vec2(-2.0, 0.0));
  }


  var body = world.createBody({type:'kinematic'});
  body.setPosition({x: -width / 4, y: 0});
  body.createFixture(pl.Circle(BALL_R), {});
  body.setLinearVelocity(Vec2(10.0, 0.0));

  world.on('post-solve', function(contact) {
    var fA = contact.getFixtureA(), bA = fA.getBody();
    var fB = contact.getFixtureB(), bB = fB.getBody();
    var bot = fA.getUserData() == botFixDef.userData && bA || fB.getUserData() == botFixDef.userData && bB;
    bot.setLinearVelocity(Vec2(0.0, 0.0))
  });

  return world;

});


</script>


</body>

</html>